<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Projetos</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/style.css">

  <!-- JavaScript Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
    crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/bf7e05c402.js" crossorigin="anonymous"></script>
</head>

<body>
  <%- include("../partials/header.ejs")%>
    <main>
      <br><br>
      <section id="area-login">
        <div class="container">
          <div class="col-md-12">
            <h4 id="titulo-pagina">Projetos</h4>
          </div>
          <section class="col-md-12 mx-auto m-0">
              <form action="/projects/search" class="d-flex" role="search" method="get">
                <input class="form-control me-2" type="search" placeholder="Pesquise um usuário" aria-label="Search"
                name="key">
                <button class="btn btn-outline-success" type="submit">Buscar</button>
              </form>
              <a href="/project/register" type="button" class="btn btn-secondary">Cadastrar projeto</a><br><br>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th scope="col">Nome do projeto</th>
                  <th scope="col">Cep</th>
                  <th scope="col">valor</th>
                  <th scope="col">status</th>
                  <th scope="col">Data limite</th>
                  <th scope="col">Usuário</th>
                  <th scope="col">Detalhes</th>
                  <th scope="col">Excluir</th>
                </tr>
            </thead>
            <% project.forEach(project => { %>
              <tbody class="table-group-divider">
                <tr>
                  <th scope="row">
                    <%= project.title %>
                  </th>
                  <td>
                    <%= project.zipe_code %>
                  </td>
                  <td>
                    <%= project.cost %>
                  </td>
                  <td>
                    <form action="/project/<%= project.id %>/done?_method=PATCH" method="POST">
                      <div class="col-md-4">
                        <input class="form-check-input" type="checkbox" value="true" id="invalidCheck" required name="done">
                        <label class="form-check-label" for="invalidCheck">
                          <div class="col-md-10" id="cadastrar-projeto">
                            <% if(project.done) { %>
                              <p>Concluído</p>
                          <% } else { %>
                              <p>Em andamento</p>
                        <%  }  %>
                          </div>
                        </label>
                      </div>
                      <button type="submit" class="btn btn-primary">Salvar</button>
                    </form>
                  </td>
                  <td>
                    <%= project.deadline %>
                  </td>
                  <td>
                    <%= project.username %>
                  </td>
                  <td>
                    <a href="/project/<%= project.id %>" type="button" class="btn btn-secondary">Ver dados</a>
                  </td>
                  <td>
                    <form class="row g-3" action="/projects/<%= project.id %>?_method=DELETE" method="POST">
                      <button id="btn-dager"type="submit" class="btn btn-danger">Deletar</button>
                    </form>
                  </td>
                </tr>
              </tbody>
              <% }); %>
                </table>
          </section>
        </div>
      </section>
    </main>
    <%- include('../partials/footer') %>
      <!-- JavaScript Bundle with Popper -->
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.6.15/dist/sweetalert2.all.min.js"></script>
      <script src="/js/app.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>
</body>

</html>